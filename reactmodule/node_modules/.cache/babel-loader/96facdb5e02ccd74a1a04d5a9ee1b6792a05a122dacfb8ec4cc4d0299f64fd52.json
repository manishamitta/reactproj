{"ast":null,"code":"import getSharedResource from \"@ui5/webcomponents-base/dist/getSharedResource.js\";\nimport { isEscape } from \"@ui5/webcomponents-base/dist/Keys.js\";\nconst OpenedPopupsRegistry = getSharedResource(\"OpenedPopupsRegistry\", {\n  openedRegistry: []\n});\nconst addOpenedPopup = function (instance) {\n  let parentPopovers = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : [];\n  if (!OpenedPopupsRegistry.openedRegistry.some(popup => popup.instance === instance)) {\n    OpenedPopupsRegistry.openedRegistry.push({\n      instance,\n      parentPopovers\n    });\n  }\n  _updateTopModalPopup();\n  if (OpenedPopupsRegistry.openedRegistry.length === 1) {\n    attachGlobalListener();\n  }\n};\nconst removeOpenedPopup = instance => {\n  OpenedPopupsRegistry.openedRegistry = OpenedPopupsRegistry.openedRegistry.filter(el => {\n    return el.instance !== instance;\n  });\n  _updateTopModalPopup();\n  if (!OpenedPopupsRegistry.openedRegistry.length) {\n    detachGlobalListener();\n  }\n};\nconst getOpenedPopups = () => {\n  return [...OpenedPopupsRegistry.openedRegistry];\n};\nconst _keydownListener = event => {\n  if (!OpenedPopupsRegistry.openedRegistry.length) {\n    return;\n  }\n  if (isEscape(event)) {\n    event.stopPropagation();\n    OpenedPopupsRegistry.openedRegistry[OpenedPopupsRegistry.openedRegistry.length - 1].instance.closePopup(true);\n  }\n};\nconst attachGlobalListener = () => {\n  document.addEventListener(\"keydown\", _keydownListener);\n};\nconst detachGlobalListener = () => {\n  document.removeEventListener(\"keydown\", _keydownListener);\n};\nconst _updateTopModalPopup = () => {\n  let popup;\n  let hasModal = false;\n  for (let i = OpenedPopupsRegistry.openedRegistry.length - 1; i >= 0; i--) {\n    popup = OpenedPopupsRegistry.openedRegistry[i].instance;\n    if (!hasModal && popup.isModal) {\n      popup.isTopModalPopup = true;\n      hasModal = true;\n    } else {\n      popup.isTopModalPopup = false;\n    }\n  }\n};\nexport { addOpenedPopup, removeOpenedPopup, getOpenedPopups };","map":{"version":3,"names":["getSharedResource","isEscape","OpenedPopupsRegistry","openedRegistry","addOpenedPopup","instance","parentPopovers","arguments","length","undefined","some","popup","push","_updateTopModalPopup","attachGlobalListener","removeOpenedPopup","filter","el","detachGlobalListener","getOpenedPopups","_keydownListener","event","stopPropagation","closePopup","document","addEventListener","removeEventListener","hasModal","i","isModal","isTopModalPopup"],"sources":["/home/user/projects/reactproj/node_modules/@ui5/webcomponents/src/popup-utils/OpenedPopupsRegistry.ts"],"sourcesContent":["import getSharedResource from \"@ui5/webcomponents-base/dist/getSharedResource.js\";\nimport { isEscape } from \"@ui5/webcomponents-base/dist/Keys.js\";\nimport type Popup from \"../Popup.js\";\n\ntype RegisteredPopup = {\n\tinstance: Popup;\n\tparentPopovers: Array<Popup>;\n}\n\nconst OpenedPopupsRegistry = getSharedResource<{ openedRegistry: Array<RegisteredPopup> }>(\"OpenedPopupsRegistry\", { openedRegistry: [] });\n\nconst addOpenedPopup = (instance: Popup, parentPopovers: Array<Popup> = []) => {\n\tif (!OpenedPopupsRegistry.openedRegistry.some(popup => popup.instance === instance)) {\n\t\tOpenedPopupsRegistry.openedRegistry.push({\n\t\t\tinstance,\n\t\t\tparentPopovers,\n\t\t});\n\t}\n\n\t_updateTopModalPopup();\n\n\tif (OpenedPopupsRegistry.openedRegistry.length === 1) {\n\t\tattachGlobalListener();\n\t}\n};\n\nconst removeOpenedPopup = (instance: Popup) => {\n\tOpenedPopupsRegistry.openedRegistry = OpenedPopupsRegistry.openedRegistry.filter(el => {\n\t\treturn el.instance !== instance;\n\t});\n\n\t_updateTopModalPopup();\n\n\tif (!OpenedPopupsRegistry.openedRegistry.length) {\n\t\tdetachGlobalListener();\n\t}\n};\n\nconst getOpenedPopups = () => {\n\treturn [...OpenedPopupsRegistry.openedRegistry];\n};\n\nconst _keydownListener = (event: KeyboardEvent) => {\n\tif (!OpenedPopupsRegistry.openedRegistry.length) {\n\t\treturn;\n\t}\n\n\tif (isEscape(event)) {\n\t\tevent.stopPropagation();\n\t\tOpenedPopupsRegistry.openedRegistry[OpenedPopupsRegistry.openedRegistry.length - 1].instance.closePopup(true);\n\t}\n};\n\nconst attachGlobalListener = () => {\n\tdocument.addEventListener(\"keydown\", _keydownListener);\n};\n\nconst detachGlobalListener = () => {\n\tdocument.removeEventListener(\"keydown\", _keydownListener);\n};\n\nconst _updateTopModalPopup = () => {\n\tlet popup;\n\tlet hasModal = false;\n\n\tfor (let i = OpenedPopupsRegistry.openedRegistry.length - 1; i >= 0; i--) {\n\t\tpopup = OpenedPopupsRegistry.openedRegistry[i].instance;\n\n\t\tif (!hasModal && popup.isModal) {\n\t\t\tpopup.isTopModalPopup = true;\n\t\t\thasModal = true;\n\t\t} else {\n\t\t\tpopup.isTopModalPopup = false;\n\t\t}\n\t}\n};\n\nexport { addOpenedPopup, removeOpenedPopup, getOpenedPopups };\n"],"mappings":"AAAA,OAAOA,iBAAiB,MAAM,mDAAmD;AACjF,SAASC,QAAQ,QAAQ,sCAAsC;AAQ/D,MAAMC,oBAAoB,GAAGF,iBAAiB,CAA6C,sBAAsB,EAAE;EAAEG,cAAc,EAAE;AAAE,CAAE,CAAC;AAE1I,MAAMC,cAAc,GAAG,SAAAA,CAACC,QAAe,EAAuC;EAAA,IAArCC,cAAA,GAAAC,SAAA,CAAAC,MAAA,QAAAD,SAAA,QAAAE,SAAA,GAAAF,SAAA,MAA+B,EAAE;EACzE,IAAI,CAACL,oBAAoB,CAACC,cAAc,CAACO,IAAI,CAACC,KAAK,IAAIA,KAAK,CAACN,QAAQ,KAAKA,QAAQ,CAAC,EAAE;IACpFH,oBAAoB,CAACC,cAAc,CAACS,IAAI,CAAC;MACxCP,QAAQ;MACRC;KACA,CAAC;;EAGHO,oBAAoB,EAAE;EAEtB,IAAIX,oBAAoB,CAACC,cAAc,CAACK,MAAM,KAAK,CAAC,EAAE;IACrDM,oBAAoB,EAAE;;AAExB,CAAC;AAED,MAAMC,iBAAiB,GAAIV,QAAe,IAAI;EAC7CH,oBAAoB,CAACC,cAAc,GAAGD,oBAAoB,CAACC,cAAc,CAACa,MAAM,CAACC,EAAE,IAAG;IACrF,OAAOA,EAAE,CAACZ,QAAQ,KAAKA,QAAQ;EAChC,CAAC,CAAC;EAEFQ,oBAAoB,EAAE;EAEtB,IAAI,CAACX,oBAAoB,CAACC,cAAc,CAACK,MAAM,EAAE;IAChDU,oBAAoB,EAAE;;AAExB,CAAC;AAED,MAAMC,eAAe,GAAGA,CAAA,KAAK;EAC5B,OAAO,CAAC,GAAGjB,oBAAoB,CAACC,cAAc,CAAC;AAChD,CAAC;AAED,MAAMiB,gBAAgB,GAAIC,KAAoB,IAAI;EACjD,IAAI,CAACnB,oBAAoB,CAACC,cAAc,CAACK,MAAM,EAAE;IAChD;;EAGD,IAAIP,QAAQ,CAACoB,KAAK,CAAC,EAAE;IACpBA,KAAK,CAACC,eAAe,EAAE;IACvBpB,oBAAoB,CAACC,cAAc,CAACD,oBAAoB,CAACC,cAAc,CAACK,MAAM,GAAG,CAAC,CAAC,CAACH,QAAQ,CAACkB,UAAU,CAAC,IAAI,CAAC;;AAE/G,CAAC;AAED,MAAMT,oBAAoB,GAAGA,CAAA,KAAK;EACjCU,QAAQ,CAACC,gBAAgB,CAAC,SAAS,EAAEL,gBAAgB,CAAC;AACvD,CAAC;AAED,MAAMF,oBAAoB,GAAGA,CAAA,KAAK;EACjCM,QAAQ,CAACE,mBAAmB,CAAC,SAAS,EAAEN,gBAAgB,CAAC;AAC1D,CAAC;AAED,MAAMP,oBAAoB,GAAGA,CAAA,KAAK;EACjC,IAAIF,KAAK;EACT,IAAIgB,QAAQ,GAAG,KAAK;EAEpB,KAAK,IAAIC,CAAC,GAAG1B,oBAAoB,CAACC,cAAc,CAACK,MAAM,GAAG,CAAC,EAAEoB,CAAC,IAAI,CAAC,EAAEA,CAAC,EAAE,EAAE;IACzEjB,KAAK,GAAGT,oBAAoB,CAACC,cAAc,CAACyB,CAAC,CAAC,CAACvB,QAAQ;IAEvD,IAAI,CAACsB,QAAQ,IAAIhB,KAAK,CAACkB,OAAO,EAAE;MAC/BlB,KAAK,CAACmB,eAAe,GAAG,IAAI;MAC5BH,QAAQ,GAAG,IAAI;KACf,MAAM;MACNhB,KAAK,CAACmB,eAAe,GAAG,KAAK;;;AAGhC,CAAC;AAED,SAAS1B,cAAc,EAAEW,iBAAiB,EAAEI,eAAe","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}