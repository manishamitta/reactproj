{"ast":null,"code":"\"use strict\";\n\nimport { DEFAULT_THEME as l } from \"../generated/AssetParameters.js\";\nimport { mergeStyles as T } from \"../ManagedStyles.js\";\nimport { fireThemeRegistered as p } from \"../theming/ThemeRegistered.js\";\nconst y = new Map(),\n  h = new Map(),\n  S = new Map(),\n  u = new Set(),\n  i = new Set(),\n  f = (e, t, r) => {\n    h.set(`${e}/${t}`, r), u.add(e), i.add(t), p(t);\n  },\n  m = (e, t, r) => {\n    S.set(`${e}/${t}`, r);\n  },\n  P = async (e, t, r) => {\n    const a = `${e}_${t}_${r || \"\"}`,\n      s = y.get(a);\n    if (s !== void 0) return s;\n    if (!i.has(t)) {\n      const c = [...i.values()].join(\", \");\n      return console.warn(`You have requested a non-registered theme ${t} - falling back to ${l}. Registered themes are: ${c}`), g(e, l);\n    }\n    const [o, d] = await Promise.all([g(e, t), r ? g(e, r, !0) : void 0]),\n      n = T(o, d);\n    return n && y.set(a, n), n;\n  },\n  g = async function (e, t) {\n    let r = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : !1;\n    const s = (r ? S : h).get(`${e}/${t}`);\n    if (!s) {\n      r || console.error(`Theme [${t}] not registered for package [${e}]`);\n      return;\n    }\n    let o;\n    try {\n      o = await s(t);\n    } catch (n) {\n      console.error(e, n.message);\n      return;\n    }\n    return o._ || o;\n  },\n  $ = () => u,\n  D = e => i.has(e);\nexport { f as registerThemePropertiesLoader, m as registerCustomThemePropertiesLoader, P as getThemeProperties, $ as getRegisteredPackages, D as isThemeRegistered };","map":{"version":3,"names":["DEFAULT_THEME","l","mergeStyles","T","fireThemeRegistered","p","y","Map","h","S","u","Set","i","f","registerThemePropertiesLoader","e","t","r","set","add","m","registerCustomThemePropertiesLoader","P","getThemeProperties","a","s","get","has","c","values","join","console","warn","g","o","d","Promise","all","n","_getThemeProperties","arguments","length","undefined","error","message","_","$","getRegisteredPackages","D","isThemeRegistered"],"sources":["/home/user/projects/reactproj/node_modules/@ui5/webcomponents-base/src/asset-registries/Themes.ts"],"sourcesContent":["import { DEFAULT_THEME } from \"../generated/AssetParameters.js\";\nimport type { StyleData, StyleDataCSP } from \"../ManagedStyles.js\";\nimport { mergeStyles } from \"../ManagedStyles.js\";\nimport { fireThemeRegistered } from \"../theming/ThemeRegistered.js\";\n\ntype ThemeData = {_: StyleDataCSP } | StyleDataCSP | string;\ntype ThemeLoader = (themeName: string) => Promise<ThemeData>;\n\nconst themeStyles = new Map<string, StyleData>();\nconst loaders = new Map<string, ThemeLoader>();\nconst customLoaders = new Map<string, ThemeLoader>();\nconst registeredPackages = new Set<string>();\nconst registeredThemes = new Set<string>();\n\nconst registerThemePropertiesLoader = (packageName: string, themeName: string, loader: ThemeLoader) => {\n\tloaders.set(`${packageName}/${themeName}`, loader);\n\tregisteredPackages.add(packageName);\n\tregisteredThemes.add(themeName);\n\tfireThemeRegistered(themeName);\n};\n\nconst registerCustomThemePropertiesLoader = (packageName: string, themeName: string, loader: ThemeLoader) => {\n\tcustomLoaders.set(`${packageName}/${themeName}`, loader);\n};\n\nconst getThemeProperties = async (packageName: string, themeName: string, externalThemeName?: string) => {\n\tconst cacheKey = `${packageName}_${themeName}_${externalThemeName || \"\"}`;\n\tconst cachedStyleData = themeStyles.get(cacheKey);\n\tif (cachedStyleData !== undefined) { // it's valid for style to be an empty string\n\t\treturn cachedStyleData;\n\t}\n\n\tif (!registeredThemes.has(themeName)) {\n\t\tconst regThemesStr = [...registeredThemes.values()].join(\", \");\n\t\tconsole.warn(`You have requested a non-registered theme ${themeName} - falling back to ${DEFAULT_THEME}. Registered themes are: ${regThemesStr}`); /* eslint-disable-line */\n\t\treturn _getThemeProperties(packageName, DEFAULT_THEME);\n\t}\n\n\tconst [style, customStyle] = await Promise.all([\n\t\t_getThemeProperties(packageName, themeName),\n\t\texternalThemeName ? _getThemeProperties(packageName, externalThemeName, true) : undefined,\n\t]);\n\n\tconst styleData = mergeStyles(style, customStyle);\n\tif (styleData) {\n\t\tthemeStyles.set(cacheKey, styleData);\n\t}\n\n\treturn styleData;\n};\n\nconst _getThemeProperties = async (packageName: string, themeName: string, forCustomTheme = false) => {\n\tconst loadersMap = forCustomTheme ? customLoaders : loaders;\n\tconst loader = loadersMap.get(`${packageName}/${themeName}`);\n\tif (!loader) {\n\t\t// no themes for package\n\t\tif (!forCustomTheme) {\n\t\t\tconsole.error(`Theme [${themeName}] not registered for package [${packageName}]`); /* eslint-disable-line */\n\t\t}\n\t\treturn;\n\t}\n\tlet data;\n\ttry {\n\t\tdata = await loader(themeName);\n\t} catch (error: unknown) {\n\t\tconst e = error as Error;\n\t\tconsole.error(packageName, e.message); /* eslint-disable-line */\n\t\treturn;\n\t}\n\n\tconst themeProps = (data as {_: StyleDataCSP})._ || data; // Refactor: remove _ everywhere\n\treturn themeProps;\n};\n\nconst getRegisteredPackages = () => {\n\treturn registeredPackages;\n};\n\nconst isThemeRegistered = (theme: string) => {\n\treturn registeredThemes.has(theme);\n};\n\nexport {\n\tregisterThemePropertiesLoader,\n\tregisterCustomThemePropertiesLoader,\n\tgetThemeProperties,\n\tgetRegisteredPackages,\n\tisThemeRegistered,\n};\n\nexport type {\n\tThemeData,\n\tThemeLoader,\n};\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}