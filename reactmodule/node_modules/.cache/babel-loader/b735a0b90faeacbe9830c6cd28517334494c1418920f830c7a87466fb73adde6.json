{"ast":null,"code":"\"use strict\";\n\nimport y from \"../getSharedResource.js\";\nimport { getIconCollectionByAlias as D } from \"./util/IconCollectionsAlias.js\";\nimport { registerIconCollectionForTheme as h } from \"./util/IconCollectionsByTheme.js\";\nimport m from \"./util/getIconCollectionByTheme.js\";\nimport { getI18nBundle as C } from \"../i18nBundle.js\";\nconst w = \"legacy\",\n  c = new Map(),\n  s = y(\"SVGIcons.registry\", new Map()),\n  i = y(\"SVGIcons.promises\", new Map()),\n  l = \"ICON_NOT_FOUND\",\n  T = (e, t) => {\n    c.set(e, t);\n  },\n  N = async e => {\n    if (!i.has(e)) {\n      if (!c.has(e)) throw new Error(`No loader registered for the ${e} icons collection. Probably you forgot to import the \"AllIcons.js\" module for the respective package.`);\n      const t = c.get(e);\n      i.set(e, t(e));\n    }\n    return i.get(e);\n  },\n  I = e => {\n    Object.keys(e.data).forEach(t => {\n      const o = e.data[t];\n      f(t, {\n        pathData: o.path || o.paths,\n        ltr: o.ltr,\n        accData: o.acc,\n        collection: e.collection,\n        packageName: e.packageName\n      });\n    });\n  },\n  f = (e, t) => {\n    const o = `${t.collection}/${e}`;\n    s.set(o, {\n      pathData: t.pathData,\n      ltr: t.ltr,\n      accData: t.accData,\n      packageName: t.packageName,\n      customTemplate: t.customTemplate,\n      viewBox: t.viewBox,\n      collection: t.collection\n    });\n  },\n  d = e => {\n    e.startsWith(\"sap-icon://\") && (e = e.replace(\"sap-icon://\", \"\"));\n    let t;\n    return [e, t] = e.split(\"/\").reverse(), e = e.replace(\"icon-\", \"\"), t && (t = D(t)), {\n      name: e,\n      collection: t\n    };\n  },\n  u = e => {\n    const {\n      name: t,\n      collection: o\n    } = d(e);\n    return g(o, t);\n  },\n  n = async e => {\n    const {\n      name: t,\n      collection: o\n    } = d(e);\n    let r = l;\n    try {\n      r = await N(m(o));\n    } catch (a) {\n      console.error(a.message);\n    }\n    if (r === l) return r;\n    const p = g(o, t);\n    return p || (Array.isArray(r) ? r.forEach(a => {\n      I(a), h(o, {\n        [a.themeFamily || w]: a.collection\n      });\n    }) : I(r), g(o, t));\n  },\n  g = (e, t) => {\n    const o = `${m(e)}/${t}`;\n    return s.get(o);\n  },\n  A = async e => {\n    if (!e) return;\n    let t = u(e);\n    if (t || (t = await n(e)), t && t !== l && t.accData) return (await C(t.packageName)).getText(t.accData);\n  },\n  k = async () => (await n(\"edit\"), await n(\"tnt/arrow\"), await n(\"business-suite/3d\"), Array.from(s.keys()));\nexport { T as registerIconLoader, n as getIconData, u as getIconDataSync, A as getIconAccessibleName, f as registerIcon, k as _getRegisteredNames };","map":{"version":3,"names":["y","getIconCollectionByAlias","D","registerIconCollectionForTheme","h","m","getI18nBundle","C","w","c","Map","s","i","l","T","registerIconLoader","e","t","set","N","has","Error","get","I","Object","keys","data","forEach","o","f","pathData","path","paths","ltr","accData","acc","collection","packageName","registerIcon","customTemplate","viewBox","d","startsWith","replace","split","reverse","name","u","g","n","r","a","console","error","message","p","Array","isArray","themeFamily","getRegisteredIconData","A","getText","k","_getRegisteredNames","from","getIconData","getIconDataSync","getIconAccessibleName"],"sources":["/home/user/projects/reactproj/node_modules/@ui5/webcomponents-base/src/asset-registries/Icons.ts"],"sourcesContent":["import getSharedResource from \"../getSharedResource.js\";\nimport { getIconCollectionByAlias } from \"./util/IconCollectionsAlias.js\";\nimport { registerIconCollectionForTheme } from \"./util/IconCollectionsByTheme.js\";\nimport getEffectiveIconCollection from \"./util/getIconCollectionByTheme.js\";\nimport { getI18nBundle } from \"../i18nBundle.js\";\nimport type { I18nText } from \"../i18nBundle.js\";\nimport type { TemplateFunction } from \"../renderer/executeTemplate.js\";\n\nconst DEFAULT_THEME_FAMILY = \"legacy\"; // includes sap_fiori_*\n\ntype IconLoader = (collectionName: string) => Promise<CollectionData | Array<CollectionData>>;\n\ntype CollectionData = {\n\tcollection: string,\n\tpackageName: string,\n\tthemeFamily?: \"legacy\" | \"sap_horizon\",\n\tversion?: string,\n\tdata: Record<string, {\n\t\tpath?: string,\n\t\tpaths?: Array<string>,\n\t\tltr?: boolean,\n\t\tacc?: I18nText,\n\t}>,\n};\n\ntype IconData = {\n\tcollection: string,\n\tpackageName: string,\n\tpathData: string | Array<string>,\n\tltr?: boolean,\n\taccData?: I18nText,\n\tcustomTemplate?: TemplateFunction,\n\tviewBox?: string,\n};\n\nconst loaders = new Map<string, IconLoader>();\nconst registry = getSharedResource<Map<string, IconData>>(\"SVGIcons.registry\", new Map());\nconst iconCollectionPromises = getSharedResource<Map<string, Promise<CollectionData| Array<CollectionData>>>>(\"SVGIcons.promises\", new Map());\n\nconst ICON_NOT_FOUND = \"ICON_NOT_FOUND\";\n\nconst registerIconLoader = (collectionName: string, loader: IconLoader) => {\n\tloaders.set(collectionName, loader);\n};\n\nconst _loadIconCollectionOnce = async (collectionName: string) => {\n\tif (!iconCollectionPromises.has(collectionName)) {\n\t\tif (!loaders.has(collectionName)) {\n\t\t\tthrow new Error(`No loader registered for the ${collectionName} icons collection. Probably you forgot to import the \"AllIcons.js\" module for the respective package.`);\n\t\t}\n\n\t\tconst loadIcons = loaders.get(collectionName)!;\n\t\ticonCollectionPromises.set(collectionName, loadIcons(collectionName));\n\t}\n\n\treturn iconCollectionPromises.get(collectionName);\n};\n\nconst _fillRegistry = (bundleData: CollectionData) => {\n\tObject.keys(bundleData.data).forEach(iconName => {\n\t\tconst iconData = bundleData.data[iconName];\n\n\t\tregisterIcon(iconName, {\n\t\t\tpathData: (iconData.path || iconData.paths)!,\n\t\t\tltr: iconData.ltr,\n\t\t\taccData: iconData.acc,\n\t\t\tcollection: bundleData.collection,\n\t\t\tpackageName: bundleData.packageName,\n\t\t});\n\t});\n};\n\n// set\nconst registerIcon = (name: string, iconData: IconData) => { // eslint-disable-line\n\tconst key = `${iconData.collection}/${name}`;\n\n\tregistry.set(key, {\n\t\tpathData: iconData.pathData,\n\t\tltr: iconData.ltr,\n\t\taccData: iconData.accData,\n\t\tpackageName: iconData.packageName,\n\t\tcustomTemplate: iconData.customTemplate,\n\t\tviewBox: iconData.viewBox,\n\t\tcollection: iconData.collection,\n\t});\n};\n\n/**\n * Processes the full icon name and splits it into - \"name\", \"collection\".\n * - removes legacy protocol (\"sap-icon://\")\n * - resolves aliases (f.e \"SAP-icons-TNT/actor\" => \"tnt/actor\")\n *\n * @param { string } name\n * @return { object }\n */\nconst processName = (name: string) => {\n\t// silently support ui5-compatible URIs\n\tif (name.startsWith(\"sap-icon://\")) {\n\t\tname = name.replace(\"sap-icon://\", \"\");\n\t}\n\n\tlet collection: string;\n\t[name, collection] = name.split(\"/\").reverse();\n\n\tname = name.replace(\"icon-\", \"\");\n\tif (collection) {\n\t\tcollection = getIconCollectionByAlias(collection);\n\t}\n\treturn { name, collection };\n};\n\nconst getIconDataSync = (iconName: string) => {\n\tconst { name, collection } = processName(iconName);\n\treturn getRegisteredIconData(collection, name);\n};\n\nconst getIconData = async (iconName: string) => {\n\tconst { name, collection } = processName(iconName);\n\n\tlet iconData: string | CollectionData | Array<CollectionData> = ICON_NOT_FOUND;\n\ttry {\n\t\ticonData = (await _loadIconCollectionOnce(getEffectiveIconCollection(collection)))!;\n\t} catch (error: unknown) {\n\t\tconst e = error as Error;\n\t\tconsole.error(e.message); /* eslint-disable-line */\n\t}\n\n\tif (iconData === ICON_NOT_FOUND) {\n\t\treturn iconData;\n\t}\n\n\tconst registeredIconData = getRegisteredIconData(collection, name);\n\n\tif (registeredIconData) {\n\t\treturn registeredIconData;\n\t}\n\n\t// not filled by another await. many getters will await on the same loader, but fill only once\n\tif (Array.isArray(iconData)) {\n\t\ticonData.forEach(data => {\n\t\t\t_fillRegistry(data);\n\t\t\tregisterIconCollectionForTheme(collection, { [data.themeFamily || DEFAULT_THEME_FAMILY]: data.collection });\n\t\t});\n\t} else {\n\t\t_fillRegistry(iconData as CollectionData);\n\t}\n\n\treturn getRegisteredIconData(collection, name);\n};\n\nconst getRegisteredIconData = (collection: string, name: string) => {\n\tconst registryKey = `${getEffectiveIconCollection(collection)}/${name}`;\n\treturn registry.get(registryKey);\n};\n\n/**\n * Returns the accessible name for the given icon,\n * or undefined if accessible name is not present.\n *\n * @param { string } name\n * @return { Promise }\n */\nconst getIconAccessibleName = async (name: string | undefined): Promise<string | undefined> => {\n\tif (!name) {\n\t\treturn;\n\t}\n\n\tlet iconData: typeof ICON_NOT_FOUND | IconData | undefined = getIconDataSync(name);\n\n\tif (!iconData) {\n\t\ticonData = await getIconData(name);\n\t}\n\n\tif (iconData && iconData !== ICON_NOT_FOUND && iconData.accData) {\n\t\tconst i18nBundle = await getI18nBundle(iconData.packageName);\n\t\treturn i18nBundle.getText(iconData.accData);\n\t}\n};\n\n// test page usage only\nconst _getRegisteredNames = async () => {\n\t// fetch one icon of each collection to trigger the bundle load\n\tawait getIconData(\"edit\");\n\tawait getIconData(\"tnt/arrow\");\n\tawait getIconData(\"business-suite/3d\");\n\treturn Array.from(registry.keys());\n};\n\nexport {\n\tregisterIconLoader,\n\tgetIconData,\n\tgetIconDataSync,\n\tgetIconAccessibleName,\n\tregisterIcon,\n\t_getRegisteredNames,\n};\n\nexport type {\n\tIconData,\n\tCollectionData,\n};\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}