{"ast":null,"code":"\"use strict\";\n\nimport { getThemeProperties as n, getRegisteredPackages as m, isThemeRegistered as d } from \"../asset-registries/Themes.js\";\nimport { removeStyle as g, createOrUpdateStyle as p } from \"../ManagedStyles.js\";\nimport c from \"./getThemeDesignerTheme.js\";\nimport { fireThemeLoaded as f } from \"./ThemeLoaded.js\";\nimport { getFeature as u } from \"../FeaturesRegistry.js\";\nimport { attachCustomThemeStylesToHead as T, getThemeRoot as h } from \"../config/ThemeRoot.js\";\nimport { DEFAULT_THEME as l } from \"../generated/AssetParameters.js\";\nimport { getCurrentRuntimeIndex as y } from \"../Runtimes.js\";\nconst s = \"@ui5/webcomponents-theming\",\n  S = () => m().has(s),\n  P = async e => {\n    if (!S()) return;\n    const t = await n(s, e);\n    t && p(t, \"data-ui5-theme-properties\", s, e);\n  },\n  E = () => {\n    g(\"data-ui5-theme-properties\", s);\n  },\n  U = async (e, t) => {\n    const o = [...m()].map(async a => {\n      if (a === s) return;\n      const i = await n(a, e, t);\n      i && p(i, `data-ui5-component-properties-${y()}`, a);\n    });\n    return Promise.all(o);\n  },\n  w = async e => {\n    const t = c();\n    if (t) return t;\n    const r = u(\"OpenUI5Support\");\n    if (r && r.isOpenUI5Detected()) {\n      if (r.cssVariablesLoaded()) return {\n        themeName: r.getConfigurationSettingsObject()?.theme,\n        baseThemeName: \"\"\n      };\n    } else if (h()) return await T(e), c();\n  },\n  I = async e => {\n    const t = await w(e);\n    !t || e !== t.themeName ? await P(e) : E();\n    const r = d(e) ? e : t && t.baseThemeName;\n    await U(r || l, t && t.themeName === e ? e : void 0), f(e);\n  };\nexport default I;","map":{"version":3,"names":["getThemeProperties","n","getRegisteredPackages","m","isThemeRegistered","d","removeStyle","g","createOrUpdateStyle","p","c","fireThemeLoaded","f","getFeature","u","attachCustomThemeStylesToHead","T","getThemeRoot","h","DEFAULT_THEME","l","getCurrentRuntimeIndex","y","s","S","isThemeBaseRegistered","has","P","e","t","E","deleteThemeBase","U","loadComponentPackages","o","map","a","i","Promise","all","w","r","isOpenUI5Detected","cssVariablesLoaded","themeName","getConfigurationSettingsObject","theme","baseThemeName","I"],"sources":["/home/user/projects/reactproj/node_modules/@ui5/webcomponents-base/src/theming/applyTheme.ts"],"sourcesContent":["import { getThemeProperties, getRegisteredPackages, isThemeRegistered } from \"../asset-registries/Themes.js\";\nimport { removeStyle, createOrUpdateStyle } from \"../ManagedStyles.js\";\nimport getThemeDesignerTheme from \"./getThemeDesignerTheme.js\";\nimport { fireThemeLoaded } from \"./ThemeLoaded.js\";\nimport { getFeature } from \"../FeaturesRegistry.js\";\nimport { attachCustomThemeStylesToHead, getThemeRoot } from \"../config/ThemeRoot.js\";\nimport type OpenUI5Support from \"../features/OpenUI5Support.js\";\nimport { DEFAULT_THEME } from \"../generated/AssetParameters.js\";\nimport { getCurrentRuntimeIndex } from \"../Runtimes.js\";\n\nconst BASE_THEME_PACKAGE = \"@ui5/webcomponents-theming\";\n\nconst isThemeBaseRegistered = () => {\n\tconst registeredPackages = getRegisteredPackages();\n\treturn registeredPackages.has(BASE_THEME_PACKAGE);\n};\n\nconst loadThemeBase = async (theme: string) => {\n\tif (!isThemeBaseRegistered()) {\n\t\treturn;\n\t}\n\n\tconst cssData = await getThemeProperties(BASE_THEME_PACKAGE, theme);\n\tif (cssData) {\n\t\tcreateOrUpdateStyle(cssData, \"data-ui5-theme-properties\", BASE_THEME_PACKAGE, theme);\n\t}\n};\n\nconst deleteThemeBase = () => {\n\tremoveStyle(\"data-ui5-theme-properties\", BASE_THEME_PACKAGE);\n};\n\nconst loadComponentPackages = async (theme: string, externalThemeName?: string) => {\n\tconst registeredPackages = getRegisteredPackages();\n\n\tconst packagesStylesPromises = [...registeredPackages].map(async packageName => {\n\t\tif (packageName === BASE_THEME_PACKAGE) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst cssData = await getThemeProperties(packageName, theme, externalThemeName);\n\t\tif (cssData) {\n\t\t\tcreateOrUpdateStyle(cssData, `data-ui5-component-properties-${getCurrentRuntimeIndex()}`, packageName);\n\t\t}\n\t});\n\n\treturn Promise.all(packagesStylesPromises);\n};\n\nconst detectExternalTheme = async (theme: string) => {\n\t// If theme designer theme is detected, use this\n\tconst extTheme = getThemeDesignerTheme();\n\tif (extTheme) {\n\t\treturn extTheme;\n\t}\n\n\t// If OpenUI5Support is enabled, try to find out if it loaded variables\n\tconst openUI5Support = getFeature<typeof OpenUI5Support>(\"OpenUI5Support\");\n\tif (openUI5Support && openUI5Support.isOpenUI5Detected()) {\n\t\tconst varsLoaded = openUI5Support.cssVariablesLoaded();\n\t\tif (varsLoaded) {\n\t\t\treturn {\n\t\t\t\tthemeName: openUI5Support.getConfigurationSettingsObject()?.theme, // just themeName\n\t\t\t\tbaseThemeName: \"\", // baseThemeName is only relevant for custom themes\n\t\t\t};\n\t\t}\n\t} else if (getThemeRoot()) {\n\t\tawait attachCustomThemeStylesToHead(theme);\n\n\t\treturn getThemeDesignerTheme();\n\t}\n};\n\nconst applyTheme = async (theme: string) => {\n\tconst extTheme = await detectExternalTheme(theme);\n\n\t// Only load theme_base properties if there is no externally loaded theme, or there is, but it is not being loaded\n\tif (!extTheme || theme !== extTheme.themeName) {\n\t\tawait loadThemeBase(theme);\n\t} else {\n\t\tdeleteThemeBase();\n\t}\n\n\t// Always load component packages properties. For non-registered themes, try with the base theme, if any\n\tconst packagesTheme = isThemeRegistered(theme) ? theme : extTheme && extTheme.baseThemeName;\n\tawait loadComponentPackages(packagesTheme || DEFAULT_THEME, extTheme && extTheme.themeName === theme ? theme : undefined);\n\n\tfireThemeLoaded(theme);\n};\n\nexport default applyTheme;\n"],"mappings":";;AAAA,SAASA,kBAAA,IAAAC,CAAA,EAAoBC,qBAAA,IAAAC,CAAA,EAAuBC,iBAAA,IAAAC,CAAA,QAAyB;AAC7E,SAASC,WAAA,IAAAC,CAAA,EAAaC,mBAAA,IAAAC,CAAA,QAA2B;AACjD,OAAOC,CAAA,MAA2B;AAClC,SAASC,eAAA,IAAAC,CAAA,QAAuB;AAChC,SAASC,UAAA,IAAAC,CAAA,QAAkB;AAC3B,SAASC,6BAAA,IAAAC,CAAA,EAA+BC,YAAA,IAAAC,CAAA,QAAoB;AAE5D,SAASC,aAAA,IAAAC,CAAA,QAAqB;AAC9B,SAASC,sBAAA,IAAAC,CAAA,QAA8B;AAEvC,MAAMC,CAAA,GAAqB;EAErBC,CAAA,GAAwBC,CAAA,KACFtB,CAAA,CAAsB,EACvBuB,GAAA,CAAIH,CAAkB;EAG3CI,CAAA,GAAgB,MAAOC,CAAA,IAAkB;IAC9C,IAAI,CAACJ,CAAA,CAAsB,GAC1B;IAGD,MAAMK,CAAA,GAAU,MAAM5B,CAAA,CAAmBsB,CAAA,EAAoBK,CAAK;IAC9DC,CAAA,IACHpB,CAAA,CAAoBoB,CAAA,EAAS,6BAA6BN,CAAA,EAAoBK,CAAK,CAErF;EAAA;EAEME,CAAA,GAAkBC,CAAA,KAAM;IAC7BxB,CAAA,CAAY,6BAA6BgB,CAAkB,CAC5D;EAAA;EAEMS,CAAA,GAAwB,MAAAC,CAAOL,CAAA,EAAeC,CAAA,KAA+B;IAGlF,MAAMK,CAAA,GAAyB,CAAC,GAFL/B,CAAA,CAAsB,CAEI,EAAEgC,GAAA,CAAI,MAAMC,CAAA,IAAe;MAC/E,IAAIA,CAAA,KAAgBb,CAAA,EACnB;MAGD,MAAMc,CAAA,GAAU,MAAMpC,CAAA,CAAmBmC,CAAA,EAAaR,CAAA,EAAOC,CAAiB;MAC1EQ,CAAA,IACH5B,CAAA,CAAoB4B,CAAA,EAAS,iCAAiCf,CAAA,CAAuB,CAAC,IAAIc,CAAW,CAEvG;IAAA,CAAC;IAED,OAAOE,OAAA,CAAQC,GAAA,CAAIL,CAAsB,CAC1C;EAAA;EAEMM,CAAA,GAAsB,MAAOZ,CAAA,IAAkB;IAEpD,MAAMC,CAAA,GAAWnB,CAAA,CAAsB;IACvC,IAAImB,CAAA,EACH,OAAOA,CAAA;IAIR,MAAMY,CAAA,GAAiB3B,CAAA,CAAkC,gBAAgB;IACzE,IAAI2B,CAAA,IAAkBA,CAAA,CAAeC,iBAAA,CAAkB;MAEtD,IADmBD,CAAA,CAAeE,kBAAA,CAAmB,GAEpD,OAAO;QACNC,SAAA,EAAWH,CAAA,CAAeI,8BAAA,CAA+B,GAAGC,KAAA;QAC5DC,aAAA,EAAe;MAChB;IAAA,WAES7B,CAAA,CAAa,GACvB,aAAMF,CAAA,CAA8BY,CAAK,GAElClB,CAAA,CAAsB,CAE/B;EAAA;EAEMsC,CAAA,GAAa,MAAOpB,CAAA,IAAkB;IAC3C,MAAMC,CAAA,GAAW,MAAMW,CAAA,CAAoBZ,CAAK;IAG5C,CAACC,CAAA,IAAYD,CAAA,KAAUC,CAAA,CAASe,SAAA,GACnC,MAAMjB,CAAA,CAAcC,CAAK,IAEzBE,CAAA,CAAgB;IAIjB,MAAMW,CAAA,GAAgBpC,CAAA,CAAkBuB,CAAK,IAAIA,CAAA,GAAQC,CAAA,IAAYA,CAAA,CAASkB,aAAA;IAC9E,MAAMf,CAAA,CAAsBS,CAAA,IAAiBrB,CAAA,EAAeS,CAAA,IAAYA,CAAA,CAASe,SAAA,KAAchB,CAAA,GAAQA,CAAA,GAAQ,MAAS,GAExHhB,CAAA,CAAgBgB,CAAK,CACtB;EAAA;AAEA,eAAeoB,CAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}