{"ast":null,"code":"\"use strict\";\n\nimport p from \"./getSharedResource.js\";\nimport { getCurrentRuntimeIndex as u, compareRuntimes as f, getAllRuntimes as b } from \"./Runtimes.js\";\nconst m = p(\"Tags\", new Map()),\n  d = new Set();\nlet s = new Map(),\n  c;\nconst g = -1,\n  h = e => {\n    d.add(e), m.set(e, u());\n  },\n  w = e => d.has(e),\n  $ = () => [...d.values()],\n  y = e => {\n    let n = m.get(e);\n    n === void 0 && (n = g), s.has(n) || s.set(n, new Set()), s.get(n).add(e), c || (c = setTimeout(() => {\n      R(), s = new Map(), c = void 0;\n    }, 1e3));\n  },\n  R = () => {\n    const e = b(),\n      n = u(),\n      l = e[n];\n    let t = \"Multiple UI5 Web Components instances detected.\";\n    e.length > 1 && (t = `${t}\nLoading order (versions before 1.1.0 not listed): ${e.map(i => `\n${i.description}`).join(\"\")}`), [...s.keys()].forEach(i => {\n      let o, r;\n      i === g ? (o = 1, r = {\n        description: \"Older unknown runtime\"\n      }) : (o = f(n, i), r = e[i]);\n      let a;\n      o > 0 ? a = \"an older\" : o < 0 ? a = \"a newer\" : a = \"the same\", t = `${t}\n\n\"${l.description}\" failed to define ${s.get(i).size} tag(s) as they were defined by a runtime of ${a} version \"${r.description}\": ${[...s.get(i)].sort().join(\", \")}.`, o > 0 ? t = `${t}\nWARNING! If your code uses features of the above web components, unavailable in ${r.description}, it might not work as expected!` : t = `${t}\nSince the above web components were defined by the same or newer version runtime, they should be compatible with your code.`;\n    }), t = `${t}\n\nTo prevent other runtimes from defining tags that you use, consider using scoping or have third-party libraries use scoping: https://github.com/SAP/ui5-webcomponents/blob/main/docs/2-advanced/03-scoping.md.`, console.warn(t);\n  };\nexport { h as registerTag, w as isTagRegistered, $ as getAllRegisteredTags, y as recordTagRegistrationFailure };","map":{"version":3,"names":["p","getCurrentRuntimeIndex","u","compareRuntimes","f","getAllRuntimes","b","m","Map","d","Set","s","c","g","h","e","add","set","w","has","$","getAllRegisteredTags","values","y","n","get","setTimeout","R","displayFailedRegistrations","l","t","length","map","i","description","join","keys","forEach","o","r","a","size","sort","console","warn","registerTag","isTagRegistered","recordTagRegistrationFailure"],"sources":["/home/user/projects/reactproj/node_modules/@ui5/webcomponents-base/src/CustomElementsRegistry.ts"],"sourcesContent":["import getSharedResource from \"./getSharedResource.js\";\nimport { getCurrentRuntimeIndex, compareRuntimes, getAllRuntimes } from \"./Runtimes.js\";\nimport type { Timeout } from \"./types.js\";\n\nconst Tags = getSharedResource<Map<string, number>>(\"Tags\", new Map());\nconst Definitions = new Set<string>();\n\nlet Failures = new Map<number, Set<string>>();\nlet failureTimeout: Timeout | undefined;\n\nconst UNKNOWN_RUNTIME = -1;\n\nconst registerTag = (tag: string) => {\n\tDefinitions.add(tag);\n\tTags.set(tag, getCurrentRuntimeIndex());\n};\n\nconst isTagRegistered = (tag: string) => {\n\treturn Definitions.has(tag);\n};\n\nconst getAllRegisteredTags = () => {\n\treturn [...Definitions.values()];\n};\n\nconst recordTagRegistrationFailure = (tag: string) => {\n\tlet tagRegRuntimeIndex = Tags.get(tag);\n\tif (tagRegRuntimeIndex === undefined) {\n\t\ttagRegRuntimeIndex = UNKNOWN_RUNTIME; // If the tag is taken, but not registered in Tags, then a version before 1.1.0 defined it => use the \"unknown\" key\n\t}\n\n\tif (!Failures.has(tagRegRuntimeIndex)) {\n\t\tFailures.set(tagRegRuntimeIndex, new Set());\n\t}\n\tFailures.get(tagRegRuntimeIndex)!.add(tag);\n\n\tif (!failureTimeout) {\n\t\tfailureTimeout = setTimeout(() => {\n\t\t\tdisplayFailedRegistrations();\n\t\t\tFailures = new Map();\n\t\t\tfailureTimeout = undefined;\n\t\t}, 1000);\n\t}\n};\n\nconst displayFailedRegistrations = () => {\n\tconst allRuntimes = getAllRuntimes();\n\tconst currentRuntimeIndex = getCurrentRuntimeIndex();\n\tconst currentRuntime = allRuntimes[currentRuntimeIndex];\n\n\tlet message = `Multiple UI5 Web Components instances detected.`;\n\n\tif (allRuntimes.length > 1) {\n\t\tmessage = `${message}\\nLoading order (versions before 1.1.0 not listed): ${allRuntimes.map(runtime => `\\n${runtime.description}`).join(\"\")}`;\n\t}\n\n\t[...Failures.keys()].forEach(otherRuntimeIndex => {\n\t\tlet comparison: number;\n\t\tlet otherRuntime;\n\n\t\tif (otherRuntimeIndex === UNKNOWN_RUNTIME) { // version < 1.1.0 defined the tag\n\t\t\tcomparison = 1; // the current runtime is considered newer\n\t\t\totherRuntime = {\n\t\t\t\tdescription: `Older unknown runtime`,\n\t\t\t};\n\t\t} else {\n\t\t\tcomparison = compareRuntimes(currentRuntimeIndex, otherRuntimeIndex);\n\t\t\totherRuntime = allRuntimes[otherRuntimeIndex];\n\t\t}\n\n\t\tlet compareWord;\n\t\tif (comparison > 0) {\n\t\t\tcompareWord = \"an older\";\n\t\t} else if (comparison < 0) {\n\t\t\tcompareWord = \"a newer\";\n\t\t} else {\n\t\t\tcompareWord = \"the same\";\n\t\t}\n\t\tmessage = `${message}\\n\\n\"${currentRuntime.description}\" failed to define ${Failures.get(otherRuntimeIndex)!.size} tag(s) as they were defined by a runtime of ${compareWord} version \"${otherRuntime.description}\": ${([...Failures.get(otherRuntimeIndex)!]).sort().join(\", \")}.`;\n\n\t\tif (comparison > 0) {\n\t\t\tmessage = `${message}\\nWARNING! If your code uses features of the above web components, unavailable in ${otherRuntime.description}, it might not work as expected!`;\n\t\t} else {\n\t\t\tmessage = `${message}\\nSince the above web components were defined by the same or newer version runtime, they should be compatible with your code.`;\n\t\t}\n\t});\n\n\tmessage = `${message}\\n\\nTo prevent other runtimes from defining tags that you use, consider using scoping or have third-party libraries use scoping: https://github.com/SAP/ui5-webcomponents/blob/main/docs/2-advanced/03-scoping.md.`;\n\n\tconsole.warn(message); // eslint-disable-line\n};\n\nexport {\n\tregisterTag,\n\tisTagRegistered,\n\tgetAllRegisteredTags,\n\trecordTagRegistrationFailure,\n};\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}