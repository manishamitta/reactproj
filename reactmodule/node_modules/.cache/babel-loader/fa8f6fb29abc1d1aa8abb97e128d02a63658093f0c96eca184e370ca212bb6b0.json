{"ast":null,"code":"\"use strict\";\n\nimport { instanceOfUI5Element as i } from \"../UI5Element.js\";\nlet n;\nconst l = new Map(),\n  a = () => (n || (n = new window.ResizeObserver(r => {\n    window.requestAnimationFrame(() => {\n      r.forEach(t => {\n        const s = l.get(t.target);\n        s && Promise.all(s.map(e => e()));\n      });\n    });\n  })), n),\n  c = (r, t) => {\n    const s = l.get(r) || [];\n    s.length || a().observe(r), l.set(r, [...s, t]);\n  },\n  b = (r, t) => {\n    const s = l.get(r) || [];\n    if (s.length === 0) return;\n    const e = s.filter(o => o !== t);\n    e.length === 0 ? (a().unobserve(r), l.delete(r)) : l.set(r, e);\n  };\nclass f {\n  static register(t, s) {\n    let e = t;\n    i(e) && (e = e.getDomRef()), e instanceof HTMLElement ? c(e, s) : console.warn(\"Cannot register ResizeHandler for element\", t);\n  }\n  static deregister(t, s) {\n    let e = t;\n    i(e) && (e = e.getDomRef()), e instanceof HTMLElement ? b(e, s) : console.warn(\"Cannot deregister ResizeHandler for element\", t);\n  }\n}\nexport default f;","map":{"version":3,"names":["instanceOfUI5Element","i","n","l","Map","a","getResizeObserver","window","ResizeObserver","r","requestAnimationFrame","forEach","t","s","get","target","Promise","all","map","e","c","observe","length","set","b","unobserve","filter","o","delete","f","register","getDomRef","HTMLElement","console","warn","deregister"],"sources":["/home/user/projects/reactproj/node_modules/@ui5/webcomponents-base/src/delegate/ResizeHandler.ts"],"sourcesContent":["import { instanceOfUI5Element } from \"../UI5Element.js\";\n\ntype ResizeObserverCallback = () => Promise<void> | void;\n\nlet resizeObserver: ResizeObserver;\nconst observedElements = new Map<HTMLElement, Array<ResizeObserverCallback>>();\n\nconst getResizeObserver = () => {\n\tif (!resizeObserver) {\n\t\tresizeObserver = new window.ResizeObserver(entries => {\n\t\t\twindow.requestAnimationFrame(() => {\n\t\t\t\tentries.forEach(entry => {\n\t\t\t\t\tconst callbacks = observedElements.get(entry.target as HTMLElement);\n\t\t\t\t\t// Callbacks could be async and we need to handle returned promises to comply with the eslint \"no-misused-promises\" rule.\n\t\t\t\t\t// Although Promise.all awaits all, we don't await the additional task after calling the callbacks and should not make any difference.\n\t\t\t\t\tcallbacks && Promise.all(callbacks.map((callback: ResizeObserverCallback) => callback()));\n\t\t\t\t});\n\t\t\t});\n\t\t});\n\t}\n\treturn resizeObserver;\n};\n\nconst observe = (element: HTMLElement, callback: ResizeObserverCallback) => {\n\tconst callbacks = observedElements.get(element) || [];\n\n\t// if no callbacks have been added for this element - start observing it\n\tif (!callbacks.length) {\n\t\tgetResizeObserver().observe(element);\n\t}\n\n\t// save the callbacks in an array\n\tobservedElements.set(element, [...callbacks, callback]);\n};\n\nconst unobserve = (element: HTMLElement, callback: ResizeObserverCallback) => {\n\tconst callbacks = observedElements.get(element) || [];\n\tif (callbacks.length === 0) {\n\t\treturn;\n\t}\n\n\tconst filteredCallbacks = callbacks.filter((fn: ResizeObserverCallback) => fn !== callback);\n\tif (filteredCallbacks.length === 0) {\n\t\tgetResizeObserver().unobserve(element);\n\t\tobservedElements.delete(element);\n\t} else {\n\t\tobservedElements.set(element, filteredCallbacks);\n\t}\n};\n\n/**\n * Allows to register/deregister resize observers for a DOM element\n *\n * @public\n * @class\n  */\nclass ResizeHandler {\n\t/**\n\t * @public\n\t * @param element UI5 Web Component or DOM Element to be observed\n\t * @param callback Callback to be executed\n\t */\n\tstatic register(element: HTMLElement, callback: ResizeObserverCallback): void {\n\t\tlet effectiveElement: HTMLElement | undefined = element;\n\n\t\tif (instanceOfUI5Element(effectiveElement)) {\n\t\t\teffectiveElement = effectiveElement.getDomRef();\n\t\t}\n\n\t\tif (effectiveElement instanceof HTMLElement) {\n\t\t\tobserve(effectiveElement, callback);\n\t\t} else {\n\t\t\tconsole.warn(\"Cannot register ResizeHandler for element\", element); // eslint-disable-line\n\t\t}\n\t}\n\n\t/**\n\t * @public\n\t * @param element UI5 Web Component or DOM Element to be unobserved\n\t * @param callback Callback to be removed\n\t */\n\tstatic deregister(element: HTMLElement, callback: ResizeObserverCallback): void {\n\t\tlet effectiveElement: HTMLElement | undefined = element;\n\n\t\tif (instanceOfUI5Element(effectiveElement)) {\n\t\t\teffectiveElement = effectiveElement.getDomRef();\n\t\t}\n\n\t\tif (effectiveElement instanceof HTMLElement) {\n\t\t\tunobserve(effectiveElement, callback);\n\t\t} else {\n\t\t\tconsole.warn(\"Cannot deregister ResizeHandler for element\", element); // eslint-disable-line\n\t\t}\n\t}\n}\n\nexport default ResizeHandler;\nexport type {\n\tResizeObserverCallback,\n};\n"],"mappings":";;AAAA,SAASA,oBAAA,IAAAC,CAAA,QAA4B;AAIrC,IAAIC,CAAA;AACJ,MAAMC,CAAA,GAAmB,IAAIC,GAAA;EAEvBC,CAAA,GAAoBC,CAAA,MACpBJ,CAAA,KACJA,CAAA,GAAiB,IAAIK,MAAA,CAAOC,cAAA,CAAeC,CAAA,IAAW;IACrDF,MAAA,CAAOG,qBAAA,CAAsB,MAAM;MAClCD,CAAA,CAAQE,OAAA,CAAQC,CAAA,IAAS;QACxB,MAAMC,CAAA,GAAYV,CAAA,CAAiBW,GAAA,CAAIF,CAAA,CAAMG,MAAqB;QAGlEF,CAAA,IAAaG,OAAA,CAAQC,GAAA,CAAIJ,CAAA,CAAUK,GAAA,CAAKC,CAAA,IAAqCA,CAAA,CAAS,CAAC,CAAC,CACzF;MAAA,CAAC,CACF;IAAA,CAAC,CACF;EAAA,CAAC,IAEKjB,CAAA;EAGFkB,CAAA,GAAUC,CAACZ,CAAA,EAAsBG,CAAA,KAAqC;IAC3E,MAAMC,CAAA,GAAYV,CAAA,CAAiBW,GAAA,CAAIL,CAAO,KAAK,EAAC;IAG/CI,CAAA,CAAUS,MAAA,IACdjB,CAAA,CAAkB,EAAEgB,OAAA,CAAQZ,CAAO,GAIpCN,CAAA,CAAiBoB,GAAA,CAAId,CAAA,EAAS,CAAC,GAAGI,CAAA,EAAWD,CAAQ,CAAC,CACvD;EAAA;EAEMY,CAAA,GAAYC,CAAChB,CAAA,EAAsBG,CAAA,KAAqC;IAC7E,MAAMC,CAAA,GAAYV,CAAA,CAAiBW,GAAA,CAAIL,CAAO,KAAK,EAAC;IACpD,IAAII,CAAA,CAAUS,MAAA,KAAW,GACxB;IAGD,MAAMH,CAAA,GAAoBN,CAAA,CAAUa,MAAA,CAAQC,CAAA,IAA+BA,CAAA,KAAOf,CAAQ;IACtFO,CAAA,CAAkBG,MAAA,KAAW,KAChCjB,CAAA,CAAkB,EAAEoB,SAAA,CAAUhB,CAAO,GACrCN,CAAA,CAAiByB,MAAA,CAAOnB,CAAO,KAE/BN,CAAA,CAAiBoB,GAAA,CAAId,CAAA,EAASU,CAAiB,CAEjD;EAAA;AAQA,MAAMU,CAAc;EAMnB,OAAOC,SAASlB,CAAA,EAAsBC,CAAA,EAAwC;IAC7E,IAAIM,CAAA,GAA4CP,CAAA;IAE5CX,CAAA,CAAqBkB,CAAgB,MACxCA,CAAA,GAAmBA,CAAA,CAAiBY,SAAA,CAAU,IAG3CZ,CAAA,YAA4Ba,WAAA,GAC/BZ,CAAA,CAAQD,CAAA,EAAkBN,CAAQ,IAElCoB,OAAA,CAAQC,IAAA,CAAK,6CAA6CtB,CAAO,CAEnE;EAAA;EAOA,OAAOuB,WAAWvB,CAAA,EAAsBC,CAAA,EAAwC;IAC/E,IAAIM,CAAA,GAA4CP,CAAA;IAE5CX,CAAA,CAAqBkB,CAAgB,MACxCA,CAAA,GAAmBA,CAAA,CAAiBY,SAAA,CAAU,IAG3CZ,CAAA,YAA4Ba,WAAA,GAC/BR,CAAA,CAAUL,CAAA,EAAkBN,CAAQ,IAEpCoB,OAAA,CAAQC,IAAA,CAAK,+CAA+CtB,CAAO,CAErE;EAAA;AACD;AAEA,eAAeiB,CAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}