{"ast":null,"code":"/**\n * Handles drag and drop event listeners on document.body.\n * Ensures that there is only 1 listener per type attached (drag, drop, leave). Event listeners will only be attached when\n * there is at least 1 UploadCollection subscribed.\n */\nimport EventProvider from \"@ui5/webcomponents-base/dist/EventProvider.js\";\nimport UploadCollectionDnDOverlayMode from \"../types/UploadCollectionDnDMode.js\";\nconst draggingFiles = event => {\n  return event.dataTransfer && Array.from(event.dataTransfer.types).includes(\"Files\");\n};\nconst eventProvider = new EventProvider();\nconst EVENT = \"UploadCollectionBodyDndEvent\";\nlet lastDragEnter = null;\nlet globalHandlersAttached = false;\nconst ondragenter = event => {\n  if (!draggingFiles(event)) {\n    return;\n  }\n  lastDragEnter = event.target;\n  eventProvider.fireEvent(EVENT, {\n    mode: UploadCollectionDnDOverlayMode.Drag\n  });\n};\nconst ondragleave = event => {\n  if (lastDragEnter === event.target) {\n    eventProvider.fireEvent(EVENT, {\n      mode: UploadCollectionDnDOverlayMode.None\n    });\n  }\n};\nconst ondrop = () => {\n  eventProvider.fireEvent(EVENT, {\n    mode: UploadCollectionDnDOverlayMode.None\n  });\n};\nconst ondragover = event => {\n  event.preventDefault();\n};\nconst attachGlobalHandlers = () => {\n  document.body.addEventListener(\"dragenter\", ondragenter);\n  document.body.addEventListener(\"dragleave\", ondragleave);\n  document.body.addEventListener(\"drop\", ondrop);\n  document.body.addEventListener(\"dragover\", ondragover);\n};\nconst detachGlobalHandlers = () => {\n  document.body.removeEventListener(\"dragenter\", ondragenter);\n  document.body.removeEventListener(\"dragleave\", ondragleave);\n  document.body.removeEventListener(\"drop\", ondrop);\n  document.body.removeEventListener(\"dragover\", ondragover);\n  globalHandlersAttached = false;\n};\nconst attachBodyDnDHandler = handler => {\n  eventProvider.attachEvent(EVENT, handler);\n  if (!globalHandlersAttached) {\n    attachGlobalHandlers();\n    globalHandlersAttached = true;\n  }\n};\nconst detachBodyDnDHandler = handler => {\n  eventProvider.detachEvent(EVENT, handler);\n  if (!eventProvider.hasListeners(EVENT)) {\n    detachGlobalHandlers();\n  }\n};\nexport { attachBodyDnDHandler, detachBodyDnDHandler, draggingFiles };","map":{"version":3,"names":["EventProvider","UploadCollectionDnDOverlayMode","draggingFiles","event","dataTransfer","Array","from","types","includes","eventProvider","EVENT","lastDragEnter","globalHandlersAttached","ondragenter","target","fireEvent","mode","Drag","ondragleave","None","ondrop","ondragover","preventDefault","attachGlobalHandlers","document","body","addEventListener","detachGlobalHandlers","removeEventListener","attachBodyDnDHandler","handler","attachEvent","detachBodyDnDHandler","detachEvent","hasListeners"],"sources":["/home/user/projects/reactproj/node_modules/@ui5/webcomponents-fiori/src/upload-utils/UploadCollectionBodyDnD.ts"],"sourcesContent":["/**\n * Handles drag and drop event listeners on document.body.\n * Ensures that there is only 1 listener per type attached (drag, drop, leave). Event listeners will only be attached when\n * there is at least 1 UploadCollection subscribed.\n */\n\nimport EventProvider from \"@ui5/webcomponents-base/dist/EventProvider.js\";\nimport UploadCollectionDnDOverlayMode from \"../types/UploadCollectionDnDMode.js\";\n\ntype DnDEventListener = (param: DnDEventListenerParam) => void;\n\ntype DnDEventListenerParam = {\n\tmode: UploadCollectionDnDOverlayMode,\n};\n\nconst draggingFiles = (event: DragEvent) => {\n\treturn event.dataTransfer && Array.from(event.dataTransfer.types).includes(\"Files\");\n};\n\nconst eventProvider = new EventProvider<DnDEventListenerParam, void>();\nconst EVENT = \"UploadCollectionBodyDndEvent\";\nlet lastDragEnter: HTMLElement | null = null;\nlet globalHandlersAttached = false;\n\nconst ondragenter = (event: DragEvent) => {\n\tif (!draggingFiles(event)) {\n\t\treturn;\n\t}\n\n\tlastDragEnter = event.target as HTMLElement;\n\teventProvider.fireEvent(EVENT, { mode: UploadCollectionDnDOverlayMode.Drag });\n};\n\nconst ondragleave = (event: DragEvent) => {\n\tif (lastDragEnter === event.target) {\n\t\teventProvider.fireEvent(EVENT, { mode: UploadCollectionDnDOverlayMode.None });\n\t}\n};\n\nconst ondrop = () => {\n\teventProvider.fireEvent(EVENT, { mode: UploadCollectionDnDOverlayMode.None });\n};\n\nconst ondragover = (event: DragEvent) => {\n\tevent.preventDefault();\n};\n\nconst attachGlobalHandlers = () => {\n\tdocument.body.addEventListener(\"dragenter\", ondragenter);\n\tdocument.body.addEventListener(\"dragleave\", ondragleave);\n\tdocument.body.addEventListener(\"drop\", ondrop);\n\tdocument.body.addEventListener(\"dragover\", ondragover);\n};\n\nconst detachGlobalHandlers = () => {\n\tdocument.body.removeEventListener(\"dragenter\", ondragenter);\n\tdocument.body.removeEventListener(\"dragleave\", ondragleave);\n\tdocument.body.removeEventListener(\"drop\", ondrop);\n\tdocument.body.removeEventListener(\"dragover\", ondragover);\n\tglobalHandlersAttached = false;\n};\n\nconst attachBodyDnDHandler = (handler: DnDEventListener) => {\n\teventProvider.attachEvent(EVENT, handler);\n\n\tif (!globalHandlersAttached) {\n\t\tattachGlobalHandlers();\n\t\tglobalHandlersAttached = true;\n\t}\n};\n\nconst detachBodyDnDHandler = (handler: DnDEventListener) => {\n\teventProvider.detachEvent(EVENT, handler);\n\n\tif (!eventProvider.hasListeners(EVENT)) {\n\t\tdetachGlobalHandlers();\n\t}\n};\n\nexport {\n\tattachBodyDnDHandler,\n\tdetachBodyDnDHandler,\n\tdraggingFiles,\n};\n\nexport type {\n\tDnDEventListener,\n\tDnDEventListenerParam,\n};\n"],"mappings":"AAAA;;;;;AAMA,OAAOA,aAAa,MAAM,+CAA+C;AACzE,OAAOC,8BAA8B,MAAM,qCAAqC;AAQhF,MAAMC,aAAa,GAAIC,KAAgB,IAAI;EAC1C,OAAOA,KAAK,CAACC,YAAY,IAAIC,KAAK,CAACC,IAAI,CAACH,KAAK,CAACC,YAAY,CAACG,KAAK,CAAC,CAACC,QAAQ,CAAC,OAAO,CAAC;AACpF,CAAC;AAED,MAAMC,aAAa,GAAG,IAAIT,aAAa,EAA+B;AACtE,MAAMU,KAAK,GAAG,8BAA8B;AAC5C,IAAIC,aAAa,GAAuB,IAAI;AAC5C,IAAIC,sBAAsB,GAAG,KAAK;AAElC,MAAMC,WAAW,GAAIV,KAAgB,IAAI;EACxC,IAAI,CAACD,aAAa,CAACC,KAAK,CAAC,EAAE;IAC1B;;EAGDQ,aAAa,GAAGR,KAAK,CAACW,MAAqB;EAC3CL,aAAa,CAACM,SAAS,CAACL,KAAK,EAAE;IAAEM,IAAI,EAAEf,8BAA8B,CAACgB;EAAI,CAAE,CAAC;AAC9E,CAAC;AAED,MAAMC,WAAW,GAAIf,KAAgB,IAAI;EACxC,IAAIQ,aAAa,KAAKR,KAAK,CAACW,MAAM,EAAE;IACnCL,aAAa,CAACM,SAAS,CAACL,KAAK,EAAE;MAAEM,IAAI,EAAEf,8BAA8B,CAACkB;IAAI,CAAE,CAAC;;AAE/E,CAAC;AAED,MAAMC,MAAM,GAAGA,CAAA,KAAK;EACnBX,aAAa,CAACM,SAAS,CAACL,KAAK,EAAE;IAAEM,IAAI,EAAEf,8BAA8B,CAACkB;EAAI,CAAE,CAAC;AAC9E,CAAC;AAED,MAAME,UAAU,GAAIlB,KAAgB,IAAI;EACvCA,KAAK,CAACmB,cAAc,EAAE;AACvB,CAAC;AAED,MAAMC,oBAAoB,GAAGA,CAAA,KAAK;EACjCC,QAAQ,CAACC,IAAI,CAACC,gBAAgB,CAAC,WAAW,EAAEb,WAAW,CAAC;EACxDW,QAAQ,CAACC,IAAI,CAACC,gBAAgB,CAAC,WAAW,EAAER,WAAW,CAAC;EACxDM,QAAQ,CAACC,IAAI,CAACC,gBAAgB,CAAC,MAAM,EAAEN,MAAM,CAAC;EAC9CI,QAAQ,CAACC,IAAI,CAACC,gBAAgB,CAAC,UAAU,EAAEL,UAAU,CAAC;AACvD,CAAC;AAED,MAAMM,oBAAoB,GAAGA,CAAA,KAAK;EACjCH,QAAQ,CAACC,IAAI,CAACG,mBAAmB,CAAC,WAAW,EAAEf,WAAW,CAAC;EAC3DW,QAAQ,CAACC,IAAI,CAACG,mBAAmB,CAAC,WAAW,EAAEV,WAAW,CAAC;EAC3DM,QAAQ,CAACC,IAAI,CAACG,mBAAmB,CAAC,MAAM,EAAER,MAAM,CAAC;EACjDI,QAAQ,CAACC,IAAI,CAACG,mBAAmB,CAAC,UAAU,EAAEP,UAAU,CAAC;EACzDT,sBAAsB,GAAG,KAAK;AAC/B,CAAC;AAED,MAAMiB,oBAAoB,GAAIC,OAAyB,IAAI;EAC1DrB,aAAa,CAACsB,WAAW,CAACrB,KAAK,EAAEoB,OAAO,CAAC;EAEzC,IAAI,CAAClB,sBAAsB,EAAE;IAC5BW,oBAAoB,EAAE;IACtBX,sBAAsB,GAAG,IAAI;;AAE/B,CAAC;AAED,MAAMoB,oBAAoB,GAAIF,OAAyB,IAAI;EAC1DrB,aAAa,CAACwB,WAAW,CAACvB,KAAK,EAAEoB,OAAO,CAAC;EAEzC,IAAI,CAACrB,aAAa,CAACyB,YAAY,CAACxB,KAAK,CAAC,EAAE;IACvCiB,oBAAoB,EAAE;;AAExB,CAAC;AAED,SACCE,oBAAoB,EACpBG,oBAAoB,EACpB9B,aAAa","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}